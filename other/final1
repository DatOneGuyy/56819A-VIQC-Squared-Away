#pragma config(Sensor, port1,  color2,         sensorVexIQ_LED)
#pragma config(Sensor, port2,  color1,         sensorVexIQ_LED)
#pragma config(Sensor, port3,  gyro,           sensorVexIQ_Gyro)
#pragma config(Sensor, port4,  color3,         sensorVexIQ_LED)
#pragma config(Sensor, port11, color4,         sensorVexIQ_LED)
#pragma config(Sensor, port12, color5,         sensorVexIQ_LED)
#pragma config(Motor,  motor5,          arm,           tmotorVexIQ, PIDControl, encoder)
#pragma config(Motor,  motor6,          backarm,       tmotorVexIQ, PIDControl, encoder)
#pragma config(Motor,  motor7,          strafe,        tmotorVexIQ, PIDControl, encoder)
#pragma config(Motor,   motor8,          rightdrive,    tmotorVexIQ, PIDControl, driveRight, encoder)
#pragma config(Motor,  motor9,          leftdrive,     tmotorVexIQ, PIDControl, reversed, driveLeft, encoder)
#pragma config(Motor,  motor10,         spintake,      tmotorVexIQ, PIDControl, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

float e = 2.71828459045;
int k = 4000;
bool gear = true;
int lightMode = 0;

int dropDelay = 250;

bool sucking = false;
bool barfing = false;

int sign(int value) {
	return value == 0 ? 0 : abs(value) / value;
}

void setup() {
	setMotorSpeed(leftdrive, 0);
	setMotorSpeed(rightdrive, 0);
	setMotorSpeed(strafe, 0);
	setMotorSpeed(arm, 0);
	resetMotorEncoder(arm);
	resetMotorEncoder(strafe);
	resetMotorEncoder(rightdrive);
	resetMotorEncoder(leftdrive);
	resetMotorEncoder(backarm);
	setGyroSensitivity(gyro, gyroNormalSensitivity);
	resetGyro(gyro);
}

void driveReset() {
	setMotorSpeed(leftdrive, 0);
	setMotorSpeed(rightdrive, 0);
	setMotorSpeed(strafe, 0);
	resetMotorEncoder(rightdrive);
	resetMotorEncoder(leftdrive);
	resetMotorEncoder(strafe);
}

void forward(int ticks, int speed) {
	moveMotorTarget(leftdrive, ticks * sign(speed), speed);
	moveMotorTarget(rightdrive, ticks * sign(speed), speed);
	waitUntilMotorStop(leftdrive);
	setMotorSpeed(leftdrive, 0);
	setMotorSpeed(rightdrive, 0);
}

void turnLeft(int degrees, int speed) {
	setup();
	while (abs(degrees) > abs(getGyroDegrees(gyro))) {
		setMotorSpeed(leftdrive, -speed);
		setMotorSpeed(rightdrive, speed);
	}
	driveReset();
}

void turnRight(int degrees, int speed) {
	setup();
	while (abs(degrees) > abs(getGyroDegrees(gyro))) {
		setMotorSpeed(leftdrive, speed);
		setMotorSpeed(rightdrive, -speed);
	}
	driveReset();
}

//true = left, false = right
//ticks > 0 and speed > 0
void s(int ticks, int speed, bool dir) {
	/*
	driveReset();
	while (ticks > abs(getMotorEncoder(strafe))) {
		setMotorSpeed(strafe, speed * dir ? -1 : 1);
	}
	driveReset();
	*/
	resetGyro(gyro);
	moveMotorTarget(strafe, ticks * sign(speed * dir ? -1 : 1), speed * (dir ? -1 : 1));
	waitUntilMotorStop(strafe);
	driveReset();
}

void a(int ticks, int speed) {
	setMotorSpeed(arm, speed);
	sleep(ticks);
	setMotorSpeed(arm, 0);
	setup();
}

void togglesucking() {
	if (!sucking) {
		setMotorSpeed(spintake, 100);
	} else {
		setMotorSpeed(spintake, 0);
	}
}

void togglebarfing() {
	if (!barfing) {
		setMotorSpeed(spintake, -100);
		barfing = true;
	} else {
		setMotorSpeed(spintake, 0);
		barfing = false;
	}
}

void back(int speed, int ticks) {
	setMotorSpeed(backarm, speed);
	sleep(ticks);
	setMotorSpeed(backarm, 0);
}

void diagonal(int forwardSpeed, int strafeSpeed, int ticks) {
	setMotorSpeed(leftdrive, forwardSpeed);
	setMotorSpeed(rightdrive, forwardSpeed);
	setMotorSpeed(strafe, strafeSpeed);
	sleep(ticks);
	driveReset();
}

int mapFast(int value) {
	float A = 633.992;
	float C = -4.36118;
	float b = -5.4813;
	float c = 101.126;
	float k = -1.90005;
	float a = -0.0000200555;
	float n = 2.66124;
	float power = -a * pow(value - b, n);
	float denominator = k + C * pow(e, power);
	return value != 0 ? round((A / denominator + c) * (abs(value) / value)) : 0;
}

int mapSlow(int value) {
	float A = 380.95;
	float C = -4.36118;
	float b = -5.4813;
	float c = 60.6755;
	float k = -1.90005;
	float a = -0.0000200555;
	float n = 2.66124;
	float power = -a * pow(value - b, n);
	float denominator = k + C * pow(e, power);
	return value != 0 ? round((A / denominator + c) * (abs(value) / value)) : 0;
}

int t = 0;
int mode = 0;
int larm;

int sign(int value) {
	return value == 0 ? 0 : abs(value) / value;
}

bool checkIfZero() { //false if one is zero true if both are not zero
	return getJoystickValue(ChA) != 0 && getJoystickValue(ChD) != 0;
}

void updateTouchLED() {
	if (lightMode == 5) {
		lightMode = 0;
	} else {
		lightMode++;
	}
	switch (lightMode) {
		case 0:
			setTouchLEDColor(color1, colorRed);
			setTouchLEDColor(color2, colorRed);
			setTouchLEDColor(color3, colorRed);
			setTouchLEDColor(color4, colorRed);
			break;
		case 1:
			setTouchLEDColor(color1, colorOrange);
			setTouchLEDColor(color2, colorOrange);
			setTouchLEDColor(color3, colorOrange);
			setTouchLEDColor(color4, colorOrange);
			break;
		case 2:
			setTouchLEDColor(color1, colorYellow);
			setTouchLEDColor(color2, colorYellow);
			setTouchLEDColor(color3, colorYellow);
			setTouchLEDColor(color4, colorYellow);
			break;
		case 3:
			setTouchLEDColor(color1, colorGreen);
			setTouchLEDColor(color2, colorGreen);
			setTouchLEDColor(color3, colorGreen);
			setTouchLEDColor(color4, colorGreen);
			break;
		case 4:
			setTouchLEDColor(color1, colorBlue);
			setTouchLEDColor(color2, colorBlue);
			setTouchLEDColor(color3, colorBlue);
			setTouchLEDColor(color4, colorBlue);
			break;
		case 5:
			setTouchLEDColor(color1, colorViolet);
			setTouchLEDColor(color2, colorViolet);
			setTouchLEDColor(color3, colorViolet);
			setTouchLEDColor(color4, colorViolet);
			break;
		default:
			setTouchLEDColor(color1, colorRed);
			setTouchLEDColor(color2, colorRed);
			setTouchLEDColor(color3, colorRed);
			setTouchLEDColor(color4, colorRed);
			break;
	}
}

int leftspeed;
int rightspeed;

int released1 = 0;
int released2 = 0;

int taps = 0;

task main() {
	while (true) {
		if (getTouchLEDValue(color5) == 1 && taps == 0) {
			hogCPU();
			setup();
			taps = 1;
			//block 1
			setMotorSpeed(spintake, 100);
			forward(1150, 100);
			setMotorSpeed(spintake, 0);
			turnRight(65, 100);
			forward(600, 100);
			turnRight(60, 100);
			setMotorSpeed(spintake, -100);
			sleep(2000);
			setMotorSpeed(spintake, 0);
			setTouchLEDColor(color1, colorGreen);
			setTouchLEDColor(color2, colorGreen);
			setTouchLEDCOlor(color3, colorGreen);
			setTouchLEDCOlor(color4, colorGreen);
		}
		displayCenteredTextLine(1, "%d", getGyroDegrees(gyro));
		if (getJoystickValue(BtnLUp) == 1 && getJoystickValue(BtnLDown) == 0) {
			setMotorSpeed(arm, 100);
		} else if (getJoystickValue(BtnLDown) == 1 && getJoystickValue(BtnLUp) == 0) {
			setMotorSpeed(arm, -100);
		} else {
			setMotorSpeed(arm, 0);
		}
		if (getJoystickValue(BtnRDown) == 1 && getJoystickValue(BtnRUp) == 0) {
			setMotorSpeed(backarm, -100);
		} else if (getJoystickValue(BtnRUp) == 1 && getJoystickValue(BtnRDown) == 0) {
			setMotorSpeed(backarm, 100);
		} else {
			setMotorSpeed(backarm, 0);
		}
	}
}
